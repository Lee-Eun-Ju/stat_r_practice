---
title: "Time Series Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(forecast)
library(gridExtra)
```

<div align = "right">
#### Homework3 201811526 이은주
</div>

(1) phi=0.8과 AR(1)모형을 simulation 하세요 (n=1000). 시계열 그림, SACF, SPACF 그래프를 그리세요.   
```{r fig.height=5, fig.width=15}
AR1_p0.8 = arima.sim(n=1000, model=list(ar=0.8))
autoplot(AR1_p0.8) + ggtitle("AR(1) model with phi=0.8")
```
phi=0.8인 AR(1) model : yt = 0.8y(t-1) + at, at~WN   
위 모델의 그래프를 확인해봄으로써 phi=0.8인 AR(Auto Regressive) Model의 특성을 몇 가지 볼 수 있습니다. 우선, 전반적으로 y값이 올라가더라도 다시 내려오고 내려가더라도 올라오는 즉, 평균 0에서 크게 벗어나지 않는 자기회귀성을 보입니다. 또한 phi=0.8로 t시점의 y값이 이전 t-1시점의 값에 많은 영향을 받아 느리게 변동하며 |phi|<1로 AR(1) 모형이 정상성을 가지는 필요충분조건을 만족하는데 이를 그래프에서도 충분히 확인할 수 있습니다. 

```{r fig.height=3, fig.width=5}
ggAcf(AR1_p0.8) + ggtitle("ACF of AR(1) with phi=0.8")
```

```{r fig.height=3, fig.width=5}
ggPacf(AR1_p0.8) + ggtitle("PACF of AR(1) with phi=0.8")
```

또한, AR(1) model은 ACF가 지수적으로 감소하고 PACF의 경우 시차2이후부터 절단되는데 이를 그래프를 통해 알아볼 수 있습니다.

\pagebreak

(2) phi=-0.8일 때, (1)을 반복하세요. 
```{r fig.height=5, fig.width=15}
AR1_m0.8 = arima.sim(n=1000, model=list(ar=-0.8))
autoplot(AR1_m0.8) + ggtitle("AR(1) model with phi=-0.8")
```
phi=-0.8인 AR(1) model : yt = -0.8y(t-1) + at, at~WN   
위 모델의 경우 (1)과 다르게 phi=-0.8로 음수일 때의 AR(Auto Regressive) Model의 특성을 몇 가지 볼 수 있습니다. 우선, (1)과 마찬가지로 평균 0에서 크게 벗어나지 않는 자기회귀성을 보이지만 (1)과 다르게 매우 진동성이 높은 것을 알 수 있습니다. 이는 phi=-0.8로 t시점의 y값이 이전 t-1시점의 값에 많은 영향을 받으나 이것이 음수로 반대되어 영향을 미치므로 진동성이 매우 높은 것입니다. 

```{r fig.height=3, fig.width=5}
ggAcf(AR1_m0.8) + ggtitle("ACF of AR(1) with phi=-0.8")
```

```{r fig.height=3, fig.width=5}
ggPacf(AR1_m0.8) + ggtitle("PACF of AR(1) with phi=-0.8")
```

ACF에서도 phi=-0.8인 경우 지수적으로 감소는 하지만 (1)과 다르게 양수, 음수를 왔다갔다하는 것을 알 수 있으며 PACF의 경우에는 마찬가지로 시차2부터 절단된 것을 알 수 있습니다. 

\pagebreak

(3) AR(2)를 phi1 과 phi2를 임의로 설정하여 simulation하고 (1)을 반복하세요. 
```{r fig.height=5, fig.width=15}
AR2 = arima.sim(n=1000, model=list(ar=c(0.3,0.5)))
autoplot(AR2) + ggtitle("AR(2) model with phi1=0.3, phi2=0.5")
```
phi1=0.3, phi2=0.5인 AR(2) model : yt = 0.3y(t-1) + 0.5y(t-2) + at, at~WN  
우선적으로 AR(2) 모델의 경우 t시점의 y값이 이전 t-1시점에 0.3만큼 영향을 받고 t-2시점에서 0.5만큼 영향을 받습니다. 또한, phi1=0.3, phi2=0.5인 AR(2) model의 정상성을 확인해보았을 때, 0.3+0.5<1, 0.5-0.3<1, -1<0.5<1로서 정상성을 만족한다고 할 수 있으며 이를 그래프에서도 어떠한 추세나 주기 등을 보이지 않으므로 확인해 볼 수 있습니다. 

```{r fig.height=3, fig.width=5 }
ggAcf(AR2) + ggtitle("ACF of AR(1) with phi1=0.3, phi2=0.5")
```

```{r fig.height=3, fig.width=5}
ggPacf(AR2) + ggtitle("PACF of AR(1) with phi1=0.3, phi2=0.5")
```

ACF에서도 지수적으로 감소하는 것을 보아 특성방정식의 근이 실근인 것을 알 수 있고 PACF의 경우 AR(2) model이므로 시차3이후부터 절단되는 것을 그래프를 통해 알 수 있습니다.